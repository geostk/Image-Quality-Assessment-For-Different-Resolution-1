close all
clear all
tic
%d is distance to screen and h is the height of image in screen
d=60;
h=16*3/4;
load 'E:/images/rate_result_average_540.txt'
result_fid=fopen('ssim_540.txt','w');
reference_720=[138	153	22	91	6	122	107	12	41	61	128	51	35	93	148	89	103	80	115	21	82;
156	94	38	75	126	101	48	44	50	109	30	10	26	134	56	137	123	120	161	136	151;
97	19	86	62	111	18	92	158	4	110	87	164	84	150	157	165	168	73	166	58	88;
7	64	99	29	141	60	160	100	23	149	42	83	135	14	118	142	53	36	113	117	34;
152	66	13	20	77	96	5	146	68	129	40	140	49	131	1	95	59	102	90	46	9;
106	139	163	104	125	154	116	69	127	76	31	39	98	124	130	79	15	162	24	145	72;
155	16	32	143	78	114	144	25	28	132	11	167	17	45	159	119	81	52	8	67	105;
74	2	57	33	85	112	71	121	3	65	27	63	133	43	70	37	147	47	55	54	108];
reference_540=[59	127	64	100	75	144	21	123	55	80	136	126	4	104	9	50	86	121	44	83	33;
8	118	56	103	148	119	17	23	24	117	12	78	159	30	68	88	79	133	149	36	165;
152	60	166	163	57	106	26	154	10	41	140	43	97	90	15	58	122	167	48	71	85;
28	62	139	95	54	31	130	45	161	153	32	101	160	38	84	67	102	73	3	142	115;
47	99	22	52	156	145	146	29	143	66	91	89	63	70	114	134	168	53	132	96	81;
51	65	14	94	137	37	108	61	158	111	39	46	116	141	1	147	5	98	112	34	135;
72	107	49	82	124	129	19	128	6	20	162	157	151	110	138	74	2	16	7	120	18;
40	105	77	155	27	150	13	92	42	76	93	11	35	25	131	69	125	164	109	113	87];
reference_360=[122	139	41	39	126	59	151	72	56	22	133	144	73	116	161	79	28	127	98	70	18;
38	96	134	36	63	152	51	50	128	88	65	146	165	155	20	113	77	49	67	33	91;
89	44	137	52	111	150	132	68	17	34	58	42	147	136	1	30	15	106	157	47	4;
123	37	140	11	103	138	159	158	102	90	46	97	112	153	105	23	10	7	64	71	95;
5	85	135	109	87	75	163	62	25	142	80	60	100	74	3	162	84	57	141	118	9;
54	24	82	124	78	125	115	143	110	101	76	93	31	40	107	69	86	108	117	160	6;
149	114	14	32	154	29	99	156	104	66	16	83	119	168	13	148	27	131	164	94	8;
81	43	2	21	92	167	26	35	121	19	145	53	48	120	61	129	12	166	130	55	45];
for testid=1:8
    name_re=['E:/images/test',num2str(testid),'.jpg'];
    for degid=1:21
        name_de=['E:/images/540/',num2str(reference_540(testid,degid)),'.bmp'];
        image_re=double(rgb2gray(imread(name_re)));
        image_de=double(rgb2gray(imread(name_de)));
        [ssim, sqrsum_high, half_sqrsum]=imageassessment_DCT(image_re,image_de,d,h);
        fprintf(result_fid,'%f ',rate_result_average_540(reference_540(testid,degid)));
        fprintf(result_fid,'1:%f ',ssim);
        fprintf(result_fid,'2:%f ',sqrsum_high);
        fprintf(result_fid,'3:%f ',half_sqrsum);
        fprintf(result_fid,'\n');
    end
end
fclose(result_fid);
toc